#include <iostream>
using std::cerr;
using std::cout;
using std::endl;

#include <vector>
using std::vector;

#include "dataset.hxx"
#include "test_common.hxx"

void test_dataset(string name, vector<double> expected0, vector<double> expected5, vector<double> expected10) {
    Dataset *dataset = new Dataset("../data/" + name + ".csv");

    vector<double> means;
    vector<double> stds;
    dataset->get_statistics(means, stds);
    dataset->normalize(means, stds);

    vector<double> s0_values = (*dataset)[0]->values;
    vector<double> s5_values = (*dataset)[5]->values;
    vector<double> s10_values = (*dataset)[10]->values;

    print_vector(name + " sample 0", s0_values);
    print_vector(name + " sample 5", s5_values);
    print_vector(name + " sample 10", s10_values);

    compare_vectors(name + " sample 0", s0_values, expected0);
    compare_vectors(name + " sample 5", s5_values, expected5);
    compare_vectors(name + " sample 10", s10_values, expected10);

    delete dataset;
}

int main(int argc, char** argv) {
    vector<double> expected0{-0.90068117029781, 1.03205722448896, -1.34127240475983, -1.31297672726015};
    vector<double> expected5{-0.537177558966855, 1.95766908501717, -1.17067529279208, -1.0500307872214};
    vector<double> expected10{-0.537177558966855, 1.49486315475306, -1.28440670077058, -1.31297672726015};
    test_dataset("iris", expected0, expected5, expected10);

    expected0 = {1.09706398146998, -2.07333501469759, 1.26993368813994, 0.984374904803114, 1.56846632924343, 3.28351467098683, 2.65287398374317, 2.53247521640324, 2.21751500596464, 2.25574688529627, 2.48973392673762, -0.565265059068464, 2.83303086585518, 2.4875775569611, -0.214001646668954, 1.31686156839595, 0.72402615808036, 0.660819941428606, 1.14875666718618, 0.907083080997336, 1.88668962517928, -1.35929347376408, 2.30360062362256, 2.00123748932992, 1.30768627107154, 2.6166650235126, 2.10952634657226, 2.29607612756179, 2.75062224412495, 1.93701461237818};
    expected5 = {-0.476374665221343, -0.835335303420987, -0.387148067463317, -0.505650454483654, 2.23742148358942, 1.24433548639018, 0.866301595931547, 0.824655646449696, 1.00540179778533, 1.89000503845779, -0.255070293515905, -0.592661651917216, -0.321304185364051, -0.289258216662602, 0.156346702177152, 0.445543648646603, 0.160025197879214, -0.0691235536577116, 0.134118807348304, 0.486845839928615, -0.165498247116861, -0.313836332635365, -0.115009456217163, -0.244320207862265, 2.04851283483916, 1.72161644234705, 1.26324319635708, 0.905887786285116, 1.7540693875058, 2.24180160843264};
    expected10 = {0.537556015047254, 0.919273309929692, 0.442010663341892, 0.406453253711167, -1.0176858312814, -0.713541851534351, -0.700684347306461, -0.404685551314783, -1.03547556176959, -0.826124335738061, -0.0926558426133296, -0.0541643832079764, -0.198041563306049, 0.00380455573790281, -1.00403367796083, -0.905921304365515, -0.69244186189571, -0.682113879864644, -0.719484642753962, -0.284786897947343, 0.604848764481689, 1.33577127478425, 0.492621647584935, 0.47361134336154, -0.625476537339829, -0.630828229401501, -0.605871969877782, -0.226209729310947, 0.0764308934894757, 0.0318188079504589};
    test_dataset("wdbc", expected0, expected5, expected10);

    return 0;
}
